SQL Assignment Submission

=== 1
select players.name,results.result
from players,results,events,olympics
where olympics.year = '2000' and
events.name = '110m Hurdles Men' and
players.player_id = results.player_id and
events.event_id = results.event_id and
olympics.olympic_id = events.olympic_id;
**************** RESULT ***************************************************************
                   name                   | result 
------------------------------------------+--------
 Anier Garcia                             |     13
 Terrence Trammell                        |  13.16
 Mark Crear                               |  13.22
(3 rows)
=============================================================================================

=== 2
with first_letters as (
select substring(name, 0, 2)
from players
)
select count(substring)
from first_letters
where substring in ('A','E','I','O','U');
**************** RESULT ***************************************************************
 count 
-------
    84
(1 row)
=============================================================================================

=== 3
select count(name)
from events
where result_noted_in = 'points';
**************** RESULT ***************************************************************
 count 
-------
     4
(1 row)
=============================================================================================

=== 4
with num_medals as(
select countries.name,count(results.result)
from countries,results,players,events,olympics
where players.player_id = results.player_id
and olympics.year = '2000'
and olympics.olympic_id = events.olympic_id
and events.event_id = results.event_id
and players.country_id = countries.country_id
group by countries.name
)
select countries.name
from num_medals,countries
where countries.name = num_medals.name
order by (cast(num_medals.count as float)/countries.population)
limit 5;
**************** RESULT ***************************************************************
                   name                   
------------------------------------------
 China                                   
 France                                  
 Mexico                                  
 Canada                                  
 Nigeria                                 
(5 rows)
=============================================================================================

=== 5
select countries.name as country_name,count(players.player_id) as num_players
from countries,players
where countries.country_id = players.country_id
group by countries.name;
**************** RESULT ***************************************************************
              country_name               | num_players 
------------------------------------------+-------------
 Costa Rica                               |           1
 Latvia                                   |           2
 Estonia                                  |           2
 Eritrea                                  |           1
 Turkey                                   |           1
 Germany                                  |          22
 France                                   |          10
 Algeria                                  |           4
 Slovenia                                 |           1
 Japan                                    |          16
 Jamaica                                  |          18
 Spain                                    |           4
 Ukraine                                  |           9
 Belarus                                  |           7
 Cameroon                                 |           1
 Zimbabwe                                 |           1
 Saudi Arabia                             |           1
 Ireland                                  |           1
 Russia                                   |          38
 Denmark                                  |           2
 Lithuania                                |           2
 Iceland                                  |           1
 Netherlands                              |          13
 Portugal                                 |           3
 Barbados                                 |           1
 Nigeria                                  |          12
 Romania                                  |          10
 The Bahamas                              |           5
 Dominican Republic                       |           1
 Trinidad and Tobago                      |           2
 Canada                                   |           1
 China                                    |           8
 Austria                                  |           2
 Australia                                |          34
 Kenya                                    |          13
 South Africa                             |          10
 United States                            |          88
 Poland                                   |           5
 Argentina                                |           1
 Slovakia                                 |           1
 United Kingdom                           |          12
 Kazakhstan                               |           2
 Croatia                                  |           1
 Czech Republic                           |           3
 Cuba                                     |          12
 Sweden                                   |           9
 Italy                                    |          12
 Ethiopia                                 |          12
 Greece                                   |           7
 Brazil                                   |           9
 Morocco                                  |           5
 Hungary                                  |           4
 Mozambique                               |           1
 Mexico                                   |           3
 Finland                                  |           1
 Sri Lanka                                |           1
 Norway                                   |           3
 Bulgaria                                 |           1
(58 rows)

=============================================================================================

=== 6
select players.name
from players,countries
where right(players.name,1) = 'd'
and players.country_id = countries.country_id
order by countries.country_id asc,players.birthdate desc;
**************** RESULT ***************************************************************
                   name                   
------------------------------------------
 Abderrahmane Hammad                     
 Mark Ormrod                             
 Yunaika Crawford                        
 Lars Conrad                             
 Beverly McDonald                        
 Michael Blackwood                       
 Pieter van den Hoogenband               
 Trine Hattestad                         
 Darian Townsend                         
 BJ Bedford                              
 Amanda Beard                            
 Shawn Crawford                          
 Jon Drummond                            
(13 rows)
=============================================================================================

=== 7
with medal_count as(
select results.player_id,extract(year from players.birthdate) as birthyear,count(results.medal) as medal_count
from results,players,olympics,events
where players.player_id = results.player_id
and results.medal='GOLD'
and olympics.olympic_id = events.olympic_id
and events.event_id = results.event_id
and olympics.year='2000'
group by results.player_id,players.birthdate
)
select birthyear,count(player_id) as num_players, sum(medal_count) as num_medals
from medal_count
group by birthyear;
**************** RESULT ***************************************************************
 birthyear | num_players | num_medals 
-----------+-------------+------------
      1973 |           7 |          8
      1975 |           8 |          9
      1984 |           4 |          8
      1976 |           8 |          8
      1979 |           3 |          3
      1977 |           4 |          4
      1974 |           8 |         12
      1978 |           6 |          9
      1981 |           6 |          8
      1980 |           6 |          8
      1972 |           7 |          7
      1985 |           7 |         10
      1983 |           6 |          7
      1982 |           6 |          7
      1971 |           5 |          7
(15 rows)
=============================================================================================

=== 8
select events.name
from events,results
where events.event_id = results.event_id
and events.is_team_event=0
group by events.name,results.medal,results.result
having count(results.medal) > 1;
**************** RESULT ***************************************************************
                   name                   | count 
------------------------------------------+-------
 200m Backstroke Women                    |     2
 50m Freestyle Men                        |     2
 Pole Vault Men                           |     2
 200m Backstroke Men                      |     2
(4 rows)
=============================================================================================

=== 9
with gold as (
select events.event_id,results.result
from events,results
where events.name like '%Butterfly%'
and results.event_id = events.event_id
and results.medal = 'GOLD'
),
silver as (
select events.event_id,results.result
from events,results
where events.name like '%Butterfly%'
and results.event_id = events.event_id
and results.medal = 'SILVER'
)
select gold.event_id,silver.result-gold.result as difference
from gold,silver
where gold.event_id = silver.event_id
;
**************** RESULT ***************************************************************
 event_id |     difference     
----------+--------------------
 E14      |               0.18
 E44      |  0.410000000000011
 E16      |               1.36
 E46      |  0.700000000000003
 E13      | 0.0399999999999991
 E43      |  0.519999999999996
 E15      |               0.32
 E45      |  0.310000000000002
(8 rows)
=============================================================================================

=== 10
create table TeamMedals as
select players.country_id,events.event_id,medal,result
from results,events,players
where results.event_id = events.event_id
and is_team_event=1
and players.player_id = results.player_id;
**************** RESULT ***************************************************************
SELECT 262
=============================================================================================

=== 11
select countries.name, count(case when extract(year from players.birthdate) = 1975 then 1 end) 
from countries inner join players on countries.country_id = players.country_id
group by countries.name;
**************** RESULT ***************************************************************
                   name                   | count 
------------------------------------------+-------
 Costa Rica                               |     0
 Latvia                                   |     0
 Estonia                                  |     1
 Eritrea                                  |     1
 Turkey                                   |     0
 Germany                                  |     1
 France                                   |     0
 Algeria                                  |     0
 Slovenia                                 |     0
 Japan                                    |     3
 Jamaica                                  |     1
 Spain                                    |     0
 Ukraine                                  |     0
 Belarus                                  |     1
 Cameroon                                 |     0
 Zimbabwe                                 |     0
 Saudi Arabia                             |     0
 Ireland                                  |     0
 Russia                                   |     0
 Denmark                                  |     1
 Lithuania                                |     1
 Iceland                                  |     0
 Netherlands                              |     0
 Portugal                                 |     0
 Barbados                                 |     0
 Nigeria                                  |     0
 Romania                                  |     1
 The Bahamas                              |     0
 Dominican Republic                       |     0
 Trinidad and Tobago                      |     0
 Canada                                   |     0
 China                                    |     0
 Austria                                  |     0
 Australia                                |     3
 Kenya                                    |     0
 South Africa                             |     4
 United States                            |     5
 Poland                                   |     0
 Argentina                                |     0
 Slovakia                                 |     0
 United Kingdom                           |     1
 Kazakhstan                               |     1
 Croatia                                  |     0
 Czech Republic                           |     1
 Cuba                                     |     1
 Sweden                                   |     2
 Italy                                    |     1
 Ethiopia                                 |     1
 Greece                                   |     0
 Brazil                                   |     1
 Morocco                                  |     0
 Hungary                                  |     0
 Mozambique                               |     0
 Mexico                                   |     0
 Finland                                  |     0
 Sri Lanka                                |     0
 Norway                                   |     0
 Bulgaria                                 |     0
(58 rows)
=============================================================================================
